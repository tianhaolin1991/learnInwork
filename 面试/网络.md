## 协议层次以及服务类型
### OSI七层模型
- 1.物理层: 实现计算机节点之间比特流的透明传送,尽可能屏蔽掉具体传输介质和物理设备的差异
```text
物理层的主要任务是确定与传输媒体接口的一些特性
```
- 2.数据链路层: 主机之间的数据传输,总是在一段一段的链路上传送的,这就叫做链路层协议
```text
数据链路层将网络层交下来的IP数据报组装成帧,在相邻节点之间的链路上传送帧
通过控制信息我们可以知道一个帧的起止比特位置，此外，也能使接收端检测出所收到的帧有无差错，如果发现差错，数据链路层能够简单的丢弃掉这个帧，以避免继续占用网络资源。
```
- 3.网络层: 选择合适的网间路由和通信节点,确保数据按时成功传送
```text
IP协议是网络层协议
```
- 4.传输层: 传输层主要任务是为两台主机进程之间的通信提供服务.
```text
传输层协议TCP/UDP,主要用于数据报传输
nginx可能工作在传输层
```
- 5.会话层: 会话层就是负责建立、管理和终止表示层实体之间的通信会话
- 6.表示层: 表示层的作用是使通信的应用程序能够解释交换数据的含义

```text
比如加解密
```

- 7.应用层: 通过应用程序之间的交互来完成特定的网络应用

```text
HTTP协议、SMTP协议(邮件系统)、RPC协议、SQL协议等
在应用层交互的数据单元称之为报文
```

### TCP/IP 4层模型
-1. 网络接口层: 用于接收各种设备的数据
```text
TCP/IP没有对网络接口层做详细的规定,为了适配各种传输媒体,为的是在实际应用中有很大的兼容性
```
- 2.网络层
- 3.传输层
- 4.应用层
### TCP/IP 5层模型
- 5层模型是一种原理体系结构,为了能让学习者更加了解网络模型,而排出OSI 7 层模型的缺点,所以在理论上将网络接口层又重新划分为了物理层和数据链路层

### 各层设备及应用
- 1.物理层: 物理层用于解决不同传输媒介,信号如何表示的问题,它不包括传输介质
- 2.数据链路层: 解决局域网络寻址问题,典型设备是交换机
```text
数据通过网线或其他介质达到交换机,交换机通过解析mac地址,可以将信号传输给特定的主机
```
- 3.网络层: 解决如何标识各网络以及网络中的各主机问题以及如何路由分组的问题
```text
路由器通过IP地址来区分网络和网络中的不同主机
比如C类IP地址的前三位十进制数用来标识网络,第四位十进制数用来标识主机,如192.168.1.1
```
- 4.传输层: 解决进程之间基于网络通信的问题;传输错误时如何处理的问题
```text
TCP UDP协议
简单来说是将数据准确送到监听某个端口的应用进程中去
```
- 5.应用层: 在前面4层的基础上,用户支持特定的应用
```text
如支持HTTP应用的HTTP协议
用于支持邮件的SMTP协议
支持文件传送的FTP协议
```

### TCP协议
- 在说明时,我们将发起数据和请求的一端称为cli,接收端称为server以方便描述
#### 三次握手
- [ ] 三次握手的过程
- 1. cli发送连接请求,是一个随机序列号的SYN=x,并进入SYN_SEND状态
- 2. server接收到连接请求后,返回一个ACK=x+1,并发送SYN=y,请求,进入SYN_SEND状态
- 3. cli收到ACK和SYN请求后返回ACK=y+1,并进入ESTABLISHED状态,server收到后也进入ESTABLISHED状态
    
- [ ] 为什么不可以两次握手
- 两次握手会引起误连接,比如当cli发送的一条失效的SYN报文在到达Server后,Server会返回ACK.
    
### 四次挥手
- [ ] 四次挥手的过程
- 1.cli发送FIN请求并进入 FIN_WAIT1状态,告诉server端请求断开连接
- 2.server端发送ACK=x+1,并进入CLOSE_WAIT状态,不再接收cli端的数据,cli端收到后会进入FIN_WAIT2状态,等待Server继续发送数据
- 3.server端发送FIN请求,并进入LAST_ACK状态
- 4.cli发送ACK号告知server可以断开连接,并进入TIMED_WAIT状态,server端收到ACK关闭连接
- [ ] 为什么要四次挥手
- 因为cli请求断开连接,但是server还有可能有未发送完成的数据
- [ ] TIMED_WAIT为什么是2MSL(2倍报文存活时间)
- 因为cli发送的最后一个ACK可能由于网络原因丢失,这是一种保护机制让连接能够尽快释放

### HTTP协议
#### 长连接
#### 短连接
#### Socket生命周期